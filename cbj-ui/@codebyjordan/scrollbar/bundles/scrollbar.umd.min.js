!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/Observable"),require("rxjs/add/observable/fromEvent"),require("rxjs/Subject"),require("rxjs/add/observable/from"),require("rxjs/add/observable/merge"),require("rxjs/add/operator/mergeMap"),require("rxjs/add/operator/takeUntil"),require("rxjs/add/operator/map"),require("@angular/common"),require("rxjs/add/operator/filter"),require("@angular/router")):"function"==typeof define&&define.amd?define(["exports","@angular/core","rxjs/Observable","rxjs/add/observable/fromEvent","rxjs/Subject","rxjs/add/observable/from","rxjs/add/observable/merge","rxjs/add/operator/mergeMap","rxjs/add/operator/takeUntil","rxjs/add/operator/map","@angular/common","rxjs/add/operator/filter","@angular/router"],t):t(e.scrollbar={},e.ng.core,e.Rx,e.Rx.Observable,e.Rx,e.Rx.Observable,e.Rx.Observable,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.ng.common,e.Rx.Observable.prototype,e.ng.router)}(this,function(e,t,r,i,o,s,n,a,l,c,u,p,h){"use strict";var d={isRoot:!1,position:"right",alwaysVisible:!1,visibleTimeout:3e3,gridOffset:0,barOffset:".5rem",styles:{grid:{position:"absolute",top:0,bottom:0,display:"block",cursor:"pointer","z-index":99999,background:"transparent",width:"1rem","border-radius":0,margin:0,transition:"opacity 250ms ease-in-out"},bar:{position:"absolute",top:0,display:"block",cursor:"pointer",transition:"opacity 250ms ease-in-out","z-index":1e5,background:"#495057",width:".7rem","border-radius":"10px",margin:0}},classes:{wrapper:["cbj-scroll-wrapper"],grid:["cbj-scroll-grid"],bar:["cbj-scroll-bar"]}},b=function(){function e(e){this.mergeOptions(e,!0)}return e.prototype.mergeOptions=function(e,t,r){void 0===t&&(t=!1);var i=d;r&&(i=r);var o={},s={};if(e.styles){for(var n=0,a=Object.keys(e.styles);n<a.length;n++){o[u=a[n]]=Object.assign({},i.styles[u],e.styles[u])}o=Object.assign({},i.styles,o)}else o=Object.assign({},i.styles);if(e.classes){for(var l=0,c=Object.keys(e.classes);l<c.length;l++){var u;s[u=c[l]]=i.classes[u].concat(e.classes[u])}s=Object.assign({},i.classes,s)}else s=Object.assign({},i.classes);var p=Object.assign({},i,e,{styles:o},{classes:s});return t&&(this.options=p),p},Object.defineProperty(e.prototype,"isRoot",{get:function(){return this.options.isRoot},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.options.position},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alwaysVisible",{get:function(){return this.options.alwaysVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleTimeout",{get:function(){return this.options.visibleTimeout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridOffset",{get:function(){return this.options.gridOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"barOffset",{get:function(){return this.options.barOffset},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toggleClasses",{get:function(){return this.options.toggleClasses},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wStyles",{get:function(){return this.options.styles.wrapper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gStyles",{get:function(){return this.options.styles.grid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bStyles",{get:function(){return this.options.styles.bar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wClass",{get:function(){return this.options.classes.wrapper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gClass",{get:function(){return this.options.classes.grid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bClass",{get:function(){return this.options.classes.bar},enumerable:!0,configurable:!0}),e}(),f=new t.InjectionToken("Window");function g(){return window}var y=function(){function e(e){this.w=e,this.resizeObs=r.Observable.fromEvent(e,"resize")}return Object.defineProperty(e.prototype,"window",{get:function(){return this.w},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.w.innerWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMobile",{get:function(){return this.width<992},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height?this._height:this.w.innerHeight},set:function(e){this._height=e},enumerable:!0,configurable:!0}),e}();y.decorators=[{type:t.Injectable}],y.ctorParameters=function(){return[{type:Window,decorators:[{type:t.Inject,args:[f]}]}]};var m=function(){function e(e,t){this.ws=e,this.doc=t,this.scrollSubj=new o.Subject,this.ngUnsubscribe=new o.Subject,this.scrollObs=r.Observable.from(this.scrollSubj),this.childScrolling=!1}return Object.defineProperty(e.prototype,"scrollHeight",{get:function(){return this._scrollHeight?this._scrollHeight:this.doc.documentElement.scrollHeight},set:function(e){this._scrollHeight=e},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()},e.prototype.initWheel=function(e){var t=r.Observable.fromEvent(e,"DOMMouseScroll"),i=r.Observable.fromEvent(e,"mousewheel"),o=r.Observable.fromEvent(e,"wheel");return r.Observable.merge.apply(r.Observable,[t,i,o]).map(function(e){e.preventDefault();var t={x:0,y:0,type:"wheel"};return e.wheelDelta?(t.y=-.025*e.wheelDelta,t.x=e.wheelDeltaX?-.025*e.wheelDeltaX:0):t.y=e.deltaY||e.detail,t})},e.prototype.initDrag=function(e,t){var i,o=r.Observable.fromEvent(this.ws.window,"mousemove"),s=r.Observable.fromEvent(t,"mousedown"),n=r.Observable.fromEvent(this.ws.window,"mouseup"),a=s.mergeMap(function(e){var r=e.pageY,i=parseFloat(getComputedStyle(t).top);return o.map(function(e){return e.preventDefault(),i+e.pageY-r}).takeUntil(n)});if(i={start:a,end:n,move:o},this.ws.isMobile){var l=r.Observable.fromEvent(this.ws.window,"touchmove"),c=r.Observable.fromEvent(e,"touchstart"),u=r.Observable.fromEvent(this.ws.window,"touchend"),p=c.mergeMap(function(e){var r=e.targetTouches[0].pageY,i=-parseFloat(getComputedStyle(t).top);return l.map(function(e){return-(i+e.targetTouches[0].pageY-r)}).takeUntil(u)});i={start:r.Observable.merge.apply(r.Observable,[a,p]),end:r.Observable.merge.apply(r.Observable,[n,u]),move:r.Observable.merge.apply(r.Observable,[o,c])}}return i},e.prototype.getElOffsetTop=function(e){var t=e.nativeElement.getBoundingClientRect().top,r=e.nativeElement.clientTop;return t+this.scrollPos-r},e.prototype.getElOffsetBottom=function(e){var t=e.nativeElement.getBoundingClientRect().top,r=e.nativeElement.clientTop+e.nativeElement.clientHeight;return t+this.scrollPos-r},e}();m.decorators=[{type:t.Injectable}],m.ctorParameters=function(){return[{type:y},{type:Document,decorators:[{type:t.Inject,args:[u.DOCUMENT]}]}]};var v={linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},w=function(){function e(e,t,r,i,s,n){var a=this;this.el=e,this.renderer=t,this.scroll=r,this.ws=i,this.doc=s,this.router=n,this.unsubscribe=new o.Subject,this.setBarHeight=function(){var e=a.el.nativeElement;a.scrollHeight=Math.round(e.scrollHeight);var t=e.offsetHeight/e.scrollHeight*e.offsetHeight;a.renderer.setStyle(a.bar,"height",t+"px"),a.barNeeded(e.offsetHeight,t)&&a.config.alwaysVisible&&!a.hidden||a.showHideBarGrid(),a.config.isRoot&&(a.ws.height=e.clientHeight,a.scroll.scrollHeight=a.scrollHeight)},this.toggleClasses=function(e){e.remove?a.renderer.removeClass(a[e.el],e.classes):a.renderer.addClass(a[e.el],e.classes)},this.showHideBarGrid=function(){var e=a.el.nativeElement,t=e.offsetHeight/e.scrollHeight*e.offsetHeight;a.notNeeded=!a.barNeeded(e.offsetHeight,t),a.hidden?a.notNeeded||(a.renderer.setStyle(a.grid,"opacity",1),a.renderer.setStyle(a.bar,"opacity",1),a.hidden=!1,a.config.alwaysVisible||(clearTimeout(a.timeout),a.timeout=setTimeout(a.showHideBarGrid,a.config.visibleTimeout))):!a.notNeeded&&a.config.alwaysVisible||(a.renderer.setStyle(a.grid,"opacity",0),a.renderer.setStyle(a.bar,"opacity",0),a.hidden=!0)},this.resetTime=function(){clearTimeout(a.timeout),a.hidden&&!a.notNeeded&&(a.renderer.setStyle(a.grid,"opacity",1),a.renderer.setStyle(a.bar,"opacity",1),a.hidden=!1),a.timeout=setTimeout(a.showHideBarGrid,a.config.visibleTimeout)},this.dragStart=function(e){a.config.isRoot||(a.scroll.childScrolling=!0),(!a.config.isRoot||a.config.isRoot&&!1===a.scroll.childScrolling)&&(a.renderer.setStyle(a.bar,"top",e+"px"),a.scrollContent())},this.scrollContent=function(){var e=a.el.nativeElement,t=e.offsetHeight-a.bar.offsetHeight,r=parseInt(getComputedStyle(a.bar).top,10);r=Math.min(Math.max(r,0),t),r=Math.floor(r),a.renderer.setStyle(a.bar,"top",r+"px"),r=parseInt(getComputedStyle(a.bar).top,10)/(e.offsetHeight-a.bar.offsetHeight)*(e.scrollHeight-e.offsetHeight),e.scrollTop=r,a.config.isRoot&&(a.scroll.scrollPos=r,a.scroll.scrollSubj.next(r))},this.dragEnd=function(){var e=a.el.nativeElement,t=parseInt(e.style.paddingTop,10),r=parseInt(e.style.paddingBottom,10);(t>0||r>0)&&a.scrollTo(0,300,"inOutCubic"),a.config.isRoot||(a.scroll.childScrolling=!1)},this.scrollWheel=function(e){a.config.isRoot||(a.scroll.childScrolling=!0);var t,r,i=a.el.nativeElement,o=Date.now(),s=i.offsetHeight-a.bar.offsetHeight,n=function(){var l=Date.now(),c=Math.min(1,(l-o)/200),u=v.inOutQuad(c);r=parseInt(getComputedStyle(a.bar).top,10)+e.y*u,r=Math.min(Math.max(r,0),s),r=e.y>0?Math.ceil(r):Math.floor(r),a.renderer.setStyle(a.bar,"top",r+"px"),t=parseInt(getComputedStyle(a.bar).top,10)/(i.offsetHeight-a.bar.offsetHeight),r=t*(i.scrollHeight-i.offsetHeight),i.scrollTop=r,a.config.isRoot&&(a.scroll.scrollPos=r,a.scroll.scrollSubj.next(r)),c<1&&requestAnimationFrame(n),a.config.isRoot||(a.scroll.childScrolling=!1)};(!a.config.isRoot||a.config.isRoot&&!1===a.scroll.childScrolling)&&requestAnimationFrame(n)}}return e.prototype.ngOnInit=function(){this.createScrollbar()},e.prototype.ngAfterViewInit=function(){setTimeout(this.setBarHeight,250)},e.prototype.ngAfterViewChecked=function(){this.scrollHeight!==Math.round(this.el.nativeElement.scrollHeight)&&this.setBarHeight()},e.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},e.prototype.createScrollbar=function(){this.setParentsStyles(),this.setElementStyle(),this.renderWrapper(),this.renderGrid(),this.renderBar(),this.subscribe()},e.prototype.setParentsStyles=function(){var e=this.el.nativeElement,t=this.renderer.parentNode(e);this.renderer.setStyle(t,"position","relative");var r=this.doc.getElementsByTagName("BODY")[0];this.renderer.setStyle(r,"overflow","hidden")},e.prototype.setElementStyle=function(){var e=this.el.nativeElement;this.renderer.setStyle(e,"overflow","hidden")},e.prototype.renderWrapper=function(){var e=this,t=this.el.nativeElement;this.wrapper=this.renderer.createElement("div");for(var r=0,i=this.config.wClass;r<i.length;r++){var o=i[r];this.renderer.addClass(this.wrapper,o)}for(var s in setTimeout(function(){e.renderer.setStyle(e.wrapper,"margin",getComputedStyle(t).margin),e.renderer.setStyle(e.wrapper,"height",getComputedStyle(t).height)},250),this.renderer.setStyle(this.wrapper,"width","100%"),this.config.wStyles)this.config.wStyles.hasOwnProperty(s)&&this.renderer.setStyle(this.wrapper,s,this.config.wStyles[s]);this.renderer.insertBefore(this.renderer.parentNode(t),this.wrapper,t),this.renderer.appendChild(this.wrapper,t)},e.prototype.renderGrid=function(){this.grid=this.renderer.createElement("div");for(var e=0,t=this.config.gClass;e<t.length;e++){var r=t[e];this.renderer.addClass(this.grid,r)}for(var i in this.renderer.setStyle(this.grid,this.config.position,this.config.gridOffset),this.config.gStyles)this.config.gStyles.hasOwnProperty(i)&&this.renderer.setStyle(this.grid,i,this.config.gStyles[i]);this.config.alwaysVisible||this.renderer.setStyle(this.grid,"opacity",0),this.renderer.appendChild(this.wrapper,this.grid)},e.prototype.renderBar=function(){this.bar=this.renderer.createElement("div");for(var e=0,t=this.config.bClass;e<t.length;e++){var r=t[e];this.renderer.addClass(this.bar,r)}var i="right"===this.config.position?"translate3d(50%, 0, 0)":"translate3d(-50%, 0, 0)";for(var o in this.renderer.setStyle(this.bar,"transform",i),this.renderer.setStyle(this.bar,this.config.position,this.config.barOffset),this.config.bStyles)this.config.bStyles.hasOwnProperty(o)&&this.renderer.setStyle(this.bar,o,this.config.bStyles[o]);this.config.alwaysVisible?this.hidden=!1:(this.renderer.setStyle(this.bar,"opacity",0),this.hidden=!0),this.renderer.appendChild(this.wrapper,this.bar)},e.prototype.subscribe=function(){var e=this,t=this.el.nativeElement,i=this.scroll.initDrag(t,this.bar);this.scroll.initWheel(t).takeUntil(this.unsubscribe).subscribe(this.scrollWheel),this.ws.resizeObs.takeUntil(this.unsubscribe).subscribe(this.setBarHeight),i.start.takeUntil(this.unsubscribe).subscribe(this.dragStart),i.end.takeUntil(this.unsubscribe).subscribe(this.dragEnd),this.config.alwaysVisible||i.move.takeUntil(this.unsubscribe).subscribe(this.resetTime),this.config.isRoot&&this.router&&this.router.events.filter(function(e){return e instanceof h.NavigationStart}).subscribe(function(t){e.scrollTo(0,100,"linear")}),this.config.toggleClasses&&r.Observable.from(this.config.toggleClasses).takeUntil(this.unsubscribe).subscribe(this.toggleClasses)},e.prototype.barNeeded=function(e,t){return Math.round(e)-Math.round(t)>2},e.prototype.scrollTo=function(e,t,r){var i=this,o=this.el.nativeElement,s=Date.now(),n=o.scrollTop,a=o.scrollHeight-o.clientHeight,l=Math.max(o.offsetHeight/o.scrollHeight*o.offsetHeight,30),c=parseInt(o.style.paddingTop,10)||0,u=parseInt(o.style.paddingBottom,10)||0,p=function(){var h=Date.now(),d=Math.min(1,(h-s)/t),b=v[r](d);if(c>0||u>0){var f=null;c>0&&(f=-(b*(e-(f=-c))+f),i.renderer.setStyle(o,"paddingTop",f+"px")),u>0&&(f=b*(e-(f=u))+f,i.renderer.setStyle(o,"paddingBottom",f+"px"))}else o.scrollTop=b*(e-n)+n;var g=o.scrollTop/a;if(0===u){var y=Math.round(Math.round(o.clientHeight*g)-l);y>0?i.renderer.setStyle(i.bar,"top",y+"px"):i.renderer.setStyle(i.bar,"top","0")}d<1&&requestAnimationFrame(p)};requestAnimationFrame(p)},e}();w.decorators=[{type:t.Directive,args:[{selector:"[cbjScrollbar]"}]}],w.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:m},{type:y},{type:Document,decorators:[{type:t.Inject,args:[u.DOCUMENT]}]},{type:h.Router,decorators:[{type:t.Optional}]}]},w.propDecorators={config:[{type:t.Input,args:["cbjScrollbar"]}]};var O=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[{provide:f,useFactory:g},y,m]}},e}();O.decorators=[{type:t.NgModule,args:[{imports:[u.CommonModule],declarations:[w],exports:[w]}]}],O.ctorParameters=function(){return[]},e.DEFAULT_SCROLLBAR=d,e.ScrollbarConfig=b,e.WINDOW=f,e._window=g,e.WindowService=y,e.ScrollbarService=m,e.CbjScrollbarDirective=w,e.CbjScrollbarModule=O,e.ɵa=w,e.ɵb=m,e.ɵc=y,e.ɵd=f,e.ɵe=g,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=scrollbar.umd.min.js.map
